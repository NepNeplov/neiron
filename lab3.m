clc; clear;

% Цифри 0-9 у вигляді 5x3 матриць (-1 для фону, 1 для фігури) 
D0 = [1 1 1; 1 -1 1; 1 -1 1; 1 -1 1; 1 1 1];
D1 = [-1 1 -1; 1 1 -1; -1 1 -1; -1 1 -1; 1 1 1];
D2 = [1 1 1; -1 -1 1; 1 1 1; 1 -1 -1; 1 1 1];
D3 = [1 1 1; -1 -1 1; 1 1 1; -1 -1 1; 1 1 1];
D4 = [1 -1 1; 1 -1 1; 1 1 1; -1 -1 1; -1 -1 1];
D5 = [1 1 1; 1 -1 -1; 1 1 1; -1 -1 1; 1 1 1];
D6 = [1 1 1; 1 -1 -1; 1 1 1; 1 -1 1; 1 1 1];
D7 = [1 1 1; -1 -1 1; -1 1 -1; -1 1 -1; -1 1 -1];
D8 = [1 1 1; 1 -1 1; 1 1 1; 1 -1 1; 1 1 1];
D9 = [1 1 1; 1 -1 1; 1 1 1; -1 -1 1; 1 1 1];

% Показуємо цифри 
figure(1);
digits = {D0, D1, D2, D3, D4, D5, D6, D7, D8, D9};
for i = 1:10 
    subplot(2,5,i); 
    imagesc(digits{i});
    title(['Digit ', num2str(i-1)]); 
end

% Підготовка до навчання 
V = [];
for i = 1:10
    V = [V digits{i}(:)]; 
end

% Матриця ваг 
W = V * V';
W = W - diag(diag(W));

% Початковий випадковий образ 
x = sign(2*rand(5,3) - 1);
x = reshape(x, 15, 1);

% Ітерації з відновлення 
alpha = 0.8;
iter = 10;

figure(2); 
for k = 1:iter
    x = reshape(x,5,3);
    subplot(2,5,k); 
    imagesc(x); 
    title(['Iter ' num2str(k)]); 
    x = reshape(x,15,1);
    xtemp = alpha * W * x; 
    for j = 1:15
        if xtemp(j) > 0 
            x(j) = 1;
        else
            x(j) = -1;
        end 
    end
end
